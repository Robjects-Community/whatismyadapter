name: "WillowCMS"
description: "CakePHP 5.x based Content Management System with Docker"
version: "1.0.0"
type: "php-docker"

# Project paths
paths:
  root: "."
  config: "./config"
  source: "./src"
  tests: "./tests"
  plugins: "./plugins"
  docs: "./docs"
  tools: "./tools"
  logs: "./app/logs"
  cache: "./app/tmp/cache"

# Docker configuration
docker:
  compose_file: "./docker-compose.yml"
  env_file: "./config/.env"
  services:
    - name: "willowcms"
      type: "web"
      port: 8080
    - name: "mysql"
      type: "database"
      port: 3306
    - name: "redis"
      type: "cache"
      port: 6379
    - name: "mailpit"
      type: "mail"
      port: 8025

# Development scripts
scripts:
  dev_env: "./run_dev_env.sh"
  manage: "./manage.sh"
  setup_aliases: "./tools/development/setup_dev_aliases.sh"
  security_check: "./tools/security/quick_security_check.sh"
  file_management: "./tools/maintenance/refactor_helper_files.sh"

# Environment variables
environment:
  - name: "APP_ENV"
    default: "development"
  - name: "DEBUG"
    default: "true"
  - name: "DATABASE_URL"
    default: "mysql://root:rootpass@mysql:3306/cms"
  - name: "CACHE_URL"
    default: "redis://redis:6379"

# Aliases and shortcuts
aliases:
  # Docker shortcuts
  up: "docker compose up -d"
  down: "docker compose down"
  logs: "docker compose logs -f"
  shell: "docker compose exec willowcms bash"
  mysql: "docker compose exec mysql mysql -u root -p cms"
  
  # Development shortcuts
  dev: "./run_dev_env.sh --fresh-dev"
  fresh: "./run_dev_env.sh --fresh-dev"
  manage: "./manage.sh"
  test: "docker compose exec -T willowcms php vendor/bin/phpunit"
  
  # Maintenance shortcuts
  security: "./tools/security/quick_security_check.sh"
  files: "./tools/maintenance/refactor_helper_files.sh"
  clean: "./tools/maintenance/scripts/cleanup.sh"
  health: "./tools/maintenance/scripts/health_check.sh"

# Pre-command hooks (ensure rules are applied)
hooks:
  before_command:
    - echo "üöÄ WillowCMS Project - Applying project rules..."
    - echo "üìÅ Working in: $(pwd)"
    - echo "üê≥ Docker Compose: $([ -f docker-compose.yml ] && echo '‚úÖ Found' || echo '‚ùå Missing')"
    - echo "‚öôÔ∏è Environment: $([ -f config/.env ] && echo '‚úÖ Found' || echo '‚ùå Missing')"
    - echo "üìã Project rules applied from: .warp/rules/"

# Post-command hooks
hooks:
  after_command:
    - echo "‚úÖ Command completed in WillowCMS project"

# Project rules configuration
rules:
  enabled: true
  rule_directories:
    - ".warp/rules"
  
  # CakePHP specific rules
  cakephp:
    version: "5.x"
    use_docker_compose: true
    env_file_location: "./config/.env"
    
  # Docker specific rules
  docker:
    compose_file: "./docker-compose.yml"
    use_env_files: true
    hide_secrets: true
    
  # Development workflow rules
  development:
    use_phpunit_filters: true
    run_shorter_commands: true
    prefer_docker_exec: true
    
  # File organization rules
  file_organization:
    backup_directory: ".backups"
    tools_directory: "tools"
    theme_directories:
      - "plugins/DefaultTheme"
      - "plugins/AdminTheme"

# IDE configuration
ide:
  vscode:
    workspace: ".vscode/willow.code-workspace"
    settings: ".vscode/settings.json"
    launch: ".vscode/launch.json"

# Documentation
documentation:
  readme: "./README.md"
  project_docs: "./docs/project/WARP.md"
  api_docs: "./docs/api/"

# Quality assurance
quality:
  phpcs: "./tools/quality/phpcs.xml"
  psalm: "./tools/quality/psalm.xml"
  markdownlint: "./tools/quality/.markdownlint.json"

# Security settings
security:
  scan_before_commands: true
  exclude_patterns:
    - "*.sql"
    - "*.dump" 
    - "*.backup"
    - ".env*"
    - "app/tmp/*"
  
  protected_directories:
    - ".backups/"
    - "app/tmp/"
    - "config/"

# Git integration
git:
  ignore_patterns_check: true
  pre_commit_security_check: true