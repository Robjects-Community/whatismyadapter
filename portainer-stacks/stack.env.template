# ============================================================================
# WillowCMS / WhatIsMyAdapter - Portainer Stack Environment Variables
# ============================================================================
# This template contains ALL environment variables needed for Portainer deployment
# Copy this file and fill in your actual values
#
# SECURITY WARNING:
# - NEVER commit the actual stack.env file to Git
# - Store passwords securely (use password manager)
# - Rotate credentials regularly
# ============================================================================

# ============================================================================
# CRITICAL SECURITY VARIABLES (REQUIRED - CHANGE ALL VALUES!)
# ============================================================================
SECURITY_SALT=CHANGE-ME-TO-A-SECURE-64-CHARACTER-RANDOM-STRING-GENERATED-WITH-OPENSSL
MYSQL_ROOT_PASSWORD=CHANGE-ME-TO-SECURE-PASSWORD
MYSQL_PASSWORD=CHANGE-ME-TO-SECURE-PASSWORD
REDIS_PASSWORD=CHANGE-ME-TO-SECURE-PASSWORD
WILLOW_ADMIN_PASSWORD=CHANGE-ME-TO-SECURE-PASSWORD
REDIS_COMMANDER_PASSWORD=CHANGE-ME-TO-SECURE-PASSWORD

# Generate secure passwords with:
# openssl rand -base64 32  # For SECURITY_SALT (32+ chars)
# openssl rand -base64 24  # For other passwords (24+ chars)

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================
APP_NAME=WhatIsMyAdapter
APP_FULL_BASE_URL=https://whatismyadapter.me
DEBUG=false
APP_ENCODING=UTF-8
APP_DEFAULT_LOCALE=en_US
APP_DEFAULT_TIMEZONE=America/Chicago

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
MYSQL_DATABASE=whatismyadapter_db
MYSQL_USER=adapter_user
MYSQL_IMAGE_TAG=8.0
MYSQL_PORT=3310
MYSQL_INNODB_LOG_FILE_SIZE=512M
MYSQL_INNODB_BUFFER_POOL_SIZE=1G
MYSQL_MAX_CONNECTIONS=200
DB_PORT=3306

# MySQL or MariaDB Selection:
# For MySQL 8.0:    MYSQL_IMAGE_TAG=8.0
# For MariaDB LTS:  MYSQL_IMAGE_TAG=mariadb:11.4-noble

# ============================================================================
# USER PERMISSIONS (MUST MATCH SERVER USER!)
# ============================================================================
DOCKER_UID=1034
DOCKER_GID=100

# These MUST match the user created on your server:
# sudo useradd -u 1034 -g 100 -m -s /bin/bash whatismyadapter

# ============================================================================
# PORT MAPPINGS
# ============================================================================
WILLOW_HTTP_PORT=8080
PMA_HTTP_PORT=8082
MAILPIT_HTTP_PORT=8025
MAILPIT_SMTP_PORT=1125
REDIS_COMMANDER_HTTP_PORT=8084

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
REDIS_USERNAME=default
REDIS_PORT=6379
REDIS_TAG=7.2-alpine
REDIS_DATABASE=0
REDIS_MAX_MEMORY=256mb
REDIS_HEALTHCHECK_INTERVAL=10s
REDIS_HEALTHCHECK_TIMEOUT=3s
REDIS_HEALTHCHECK_RETRIES=5

# ============================================================================
# ADMIN CONFIGURATION
# ============================================================================
WILLOW_ADMIN_USERNAME=admin
WILLOW_ADMIN_EMAIL=admin@whatismyadapter.me

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================
EMAIL_HOST=mailpit
EMAIL_PORT=1025
EMAIL_USERNAME=
EMAIL_PASSWORD=
EMAIL_REPLY=hello@whatismyadapter.me
EMAIL_NOREPLY=noreply@whatismyadapter.me

# ============================================================================
# PHPMYADMIN CONFIGURATION
# ============================================================================
PMA_USER=root
PMA_PASSWORD=${MYSQL_ROOT_PASSWORD}
PHPMYADMIN_IMAGE_TAG=latest
UPLOAD_LIMIT=300M
PMA_ARBITRARY=0

# ============================================================================
# MAILPIT CONFIGURATION
# ============================================================================
MP_MAX_MESSAGES=10000
MP_SMTP_AUTH_ACCEPT_ANY=1
MP_SMTP_AUTH_ALLOW_INSECURE=1
MAILPIT_IMAGE_TAG=latest

# ============================================================================
# REDIS COMMANDER CONFIGURATION
# ============================================================================
REDIS_COMMANDER_USERNAME=admin
REDIS_COMMANDER_IMAGE_TAG=latest

# ============================================================================
# OPTIONAL API KEYS (Leave empty if not using)
# ============================================================================
OPENAI_API_KEY=
YOUTUBE_API_KEY=
TRANSLATE_API_KEY=

# ============================================================================
# PRODUCTION SETTINGS (RECOMMENDED FOR CLOUD DEPLOYMENT)
# ============================================================================
PRODUCTION_MODE=true
DEV_MODE=false
SSH_ENABLE=false
EXPERIMENTAL_TESTS=Off

# ============================================================================
# RESOURCE LIMITS (OPTIONAL but RECOMMENDED)
# ============================================================================
# WillowCMS Application Resources
WILLOWCMS_MEMORY_LIMIT=1G
WILLOWCMS_CPU_LIMIT=1.0
WILLOWCMS_MEMORY_RESERVATION=512M

# Redis Cache Resources
REDIS_MEMORY_LIMIT=512M
REDIS_CPU_LIMIT=0.5

# MySQL Database Resources
MYSQL_MEMORY_LIMIT=2G
MYSQL_CPU_LIMIT=1.0
MYSQL_MEMORY_RESERVATION=1G

# ============================================================================
# ADVANCED CONFIGURATION (OPTIONAL)
# ============================================================================
PROJECT_NAME=willowcms
VOLUME_DRIVER=local
NETWORK_NAME=willowcms_production_network
WILLOW_DB_SERVICE=mysql
WILLOW_REDIS_SERVICE=redis

# Volume Paths (Docker Volumes vs Host Paths)
# For Docker-managed volumes (recommended):
WILLOWCMS_CODE_PATH=willowcms_production_app
WILLOWCMS_LOGS_PATH=willowcms_production_logs
WILLOWCMS_NGINX_LOGS_PATH=willowcms_production_nginx_logs
WILLOWCMS_STORAGE_PATH=willowcms_production_storage

# For host-mounted volumes (alternative):
# WILLOWCMS_CODE_PATH=/volume1/docker/whatismyadapter/app
# WILLOWCMS_LOGS_PATH=/volume1/docker/whatismyadapter/logs
# WILLOWCMS_NGINX_LOGS_PATH=/volume1/docker/whatismyadapter/nginx-logs
# WILLOWCMS_STORAGE_PATH=/volume1/docker/whatismyadapter/tmp

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
LOG_DEBUG_PATH=/var/www/html/logs
LOG_ERROR_PATH=/var/www/html/logs
LOG_QUERIES_PATH=/var/www/html/logs
LOG_ADMIN_ACTIONS_PATH=/var/www/html/logs
LOG_DEBUG_FILE=debug
LOG_ERROR_FILE=error
LOG_QUERIES_FILE=queries
LOG_ADMIN_ACTIONS_FILE=bulk_actions
LOG_DEBUG_LEVELS=notice,info,debug
LOG_ERROR_LEVELS=warning,error,critical,alert,emergency

# ============================================================================
# IMAGE TAGS
# ============================================================================
WILLOWCMS_IMAGE=willowcms:production-hardened
TAG=latest

# ============================================================================
# GIT REPOSITORY (For Repository Method Deployment)
# ============================================================================
GIT_URL=https://github.com/Robjects-Community/WhatIsMyAdaptor.git
GIT_REF=main-clean

# ============================================================================
# DEPLOYMENT NOTES
# ============================================================================
# 1. Copy this file to 'stack.env'
# 2. Generate all secure passwords using openssl
# 3. Replace all CHANGE-ME values with actual secure values
# 4. Never commit stack.env to Git (add to .gitignore)
# 5. Use Portainer's "Load variables from .env file" feature
# 6. Or paste into Advanced mode environment variables editor
#
# For production:
# - Set DEBUG=false
# - Set PRODUCTION_MODE=true
# - Set DEV_MODE=false
# - Set SSH_ENABLE=false
# - Use strong unique passwords for ALL services
# - Enable resource limits
# - Use HTTPS with reverse proxy (Nginx/Caddy)
# - Configure firewall (only ports 80, 443, 22 public)
# - Schedule regular backups
# - Monitor logs and uptime
# ============================================================================
